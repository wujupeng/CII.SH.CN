# 企业设备领用与位置追溯系统 - 架构设计文档

## 1. 系统总体架构

### 1.1 三层架构设计

系统采用经典的三层架构设计：

- **表示层（前端）**：用户交互界面，负责数据展示和用户操作
- **业务逻辑层（后端）**：处理核心业务逻辑，提供API接口
- **数据访问层（数据库）**：存储和管理系统数据

### 1.2 技术栈选型

#### 前端技术栈
- **框架**：React.js
- **UI组件库**：Ant Design
- **状态管理**：Redux + Redux Toolkit
- **路由**：React Router
- **二维码扫描**：jsQR
- **HTTP客户端**：Axios
- **图表库**：ECharts

#### 后端技术栈
- **框架**：Spring Boot 2.7.x
- **ORM框架**：MyBatis-Plus
- **数据库**：MySQL 8.0
- **缓存**：Redis
- **认证授权**：Spring Security + JWT
- **API文档**：Swagger/OpenAPI
- **二维码生成**：ZXing

#### 部署技术
- **容器化**：Docker
- **持续集成/持续部署**：Jenkins

## 2. 系统模块划分

### 2.1 核心功能模块

1. **资产管理模块**
   - 资产信息录入与维护
   - 资产分类管理
   - 资产状态追踪

2. **二维码管理模块**
   - 二维码生成
   - 二维码绑定
   - 批量打印

3. **领用与归还模块**
   - 扫码领用
   - 扫码归还
   - 审批流程

4. **位置追踪模块**
   - 位置信息管理
   - 资产移动记录
   - 实时位置查询

5. **维修管理模块**
   - 维修申请
   - 维修记录
   - 维修状态追踪

6. **盘点管理模块**
   - 盘点计划创建
   - 扫码盘点
   - 异常处理
   - 盘点报表

7. **系统管理模块**
   - 用户管理
   - 部门管理
   - 权限管理
   - 系统配置

## 3. 数据库设计

### 3.1 ER图描述

系统包含以下主要实体及其关系：

- **部门(Departments)**：组织架构单元
  - 一对多：一个部门可有多个子部门
  - 一对多：一个部门可有多个用户
  - 一对多：一个部门可有多个资产

- **用户(Users)**：系统用户
  - 多对一：多个用户属于一个部门
  - 一对多：一个用户可操作多个资产

- **资产位置(AssetLocations)**：资产存放位置
  - 一对多：一个位置可有多个子位置
  - 一对多：一个位置可有多个资产
  - 多对一：多个位置属于一个部门

- **资产(Assets)**：被管理的设备
  - 多对一：多个资产属于一个部门
  - 多对一：多个资产可位于同一位置
  - 多对一：多个资产可分配给同一用户
  - 一对多：一个资产可有多个操作日志
  - 一对多：一个资产可有多个维修记录

- **资产操作日志(AssetLogs)**：记录资产的操作历史
  - 多对一：多个日志对应一个资产
  - 多对一：多个日志由同一操作员创建

- **维修记录(Repairs)**：记录资产的维修信息
  - 多对一：多个维修记录对应一个资产

- **盘点记录(Inventories)**：记录盘点活动
  - 一对多：一个盘点活动包含多个盘点明细
  - 多对一：多个盘点活动可针对同一部门/位置

- **盘点明细(InventoryDetails)**：记录单个资产的盘点结果
  - 多对一：多个盘点明细属于一个盘点活动
  - 多对一：多个盘点明细对应一个资产

## 4. API接口设计

### 4.1 RESTful API规范

系统采用RESTful API设计风格，主要遵循以下原则：

- 使用HTTP方法表示操作类型（GET、POST、PUT、DELETE）
- 使用URI表示资源
- 使用状态码表示操作结果
- 使用JSON格式传输数据

### 4.2 主要API端点

#### 资产管理
- GET /api/assets - 获取资产列表
- GET /api/assets/{id} - 获取单个资产详情
- POST /api/assets - 新增资产
- PUT /api/assets/{id} - 更新资产信息
- DELETE /api/assets/{id} - 删除资产

#### 二维码管理
- GET /api/qrcode/generate - 生成二维码
- POST /api/qrcode/batch-print - 批量打印二维码

#### 领用与归还
- POST /api/assets/{id}/allocate - 领用资产
- POST /api/assets/{id}/return - 归还资产

#### 位置管理
- GET /api/locations - 获取位置列表
- POST /api/locations - 新增位置
- PUT /api/locations/{id} - 更新位置信息

#### 盘点管理
- POST /api/inventories - 创建盘点
- GET /api/inventories - 获取盘点列表
- POST /api/inventories/{id}/scan - 扫描资产
- PUT /api/inventories/{id}/complete - 完成盘点

## 5. 安全设计

### 5.1 认证与授权

- 基于角色的访问控制（RBAC）
- JWT令牌认证
- 密码加密存储（BCrypt）

### 5.2 权限划分

- **管理员**：所有功能权限
- **部门主管**：本部门资产管理权限
- **员工**：个人资产查询和操作权限

## 6. 性能优化

### 6.1 缓存策略

- Redis缓存热点数据
- 分页查询优化
- 索引优化

### 6.2 并发控制

- 乐观锁机制
- 事务管理

## 7. 部署架构

系统支持分布式部署，主要组件包括：

- Nginx（反向代理）
- 应用服务器集群
- Redis缓存集群
- MySQL主从复制
- 日志收集系统